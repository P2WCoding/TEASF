<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCHD Travel Expense Account Settlement Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bordered { border: 1px solid black; }
        .relative { position: relative; }
        .bg-gray-200 { background-color: #f9fafb; }
        .text-center { text-align: center; }
        .font-bold { font-weight: bold; }
    </style>
</head>
<body class="p-8 bg-gray-100">

    <div class="bordered p-8 bg-white rounded-lg shadow-lg relative">
        <h1 class="text-center font-bold text-xl mb-4">MCHD Travel Expense Account Settlement Form</h1>

        <!-- Instructions Section -->
        <div class="mb-4">
            <h2 class="font-bold">Traveler Instructions:</h2>
            <p>Complete all applicable sections of this form based on actual travel expenses and forward it to your supervisor for approval. Attach all supporting documents.</p>

            <h2 class="font-bold mt-2">Supervisor Instructions:</h2>
            <p>Review and approve the completed form, then submit it to the Business Office within 30 days of the last day of travel.</p>
        </div>

        <!-- Travel Details Section -->
        <div class="grid grid-cols-3 gap-4 mb-4">
            <div><label class="font-bold">Name:</label> <input type="text" class="border p-2 w-full"></div>
            <div><label class="font-bold">Mileage Rate:</label> <input type="text" value="$0.67" class="border p-2 w-full" readonly></div>
            <div><label class="font-bold">Total Miles:</label> <input type="number" id="totalMiles" class="border p-2 w-full" oninput="calculateMileage()"></div>
        </div>

        <!-- Expense Table -->
        <table class="w-full mt-4 bordered">
            <thead>
                <tr class="bg-gray-400">
                    <th class="bordered p-2">Date of Travel</th>
                    <th class="bordered p-2">From</th>
                    <th class="bordered p-2">To</th>
                    <th class="bordered p-2">Miles</th>
                    <th class="bordered p-2">Mileage Amount</th>
                    <th class="bordered p-2">B</th>
                    <th class="bordered p-2">L</th>
                    <th class="bordered p-2">D</th>
                    <th class="bordered p-2">I</th>
                    <th class="bordered p-2">Other</th>
                    <th class="bordered p-2">Total Per Day</th>
                </tr>
            </thead>
            <tbody id="expenseTableBody">
                <!-- Example Row for First Day (will apply 75%) -->
                <tr class="bg-gray-200">
                    <td class="bordered p-2"><input type="date" class="border p-2 w-full"></td>
                    <td class="bordered p-2"><input type="text" class="border p-2 w-full"></td>
                    <td class="bordered p-2"><input type="text" class="border p-2 w-full"></td>
                    <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculateMileageAmount(this)"></td>
                    <td class="bordered p-2"><span class="mileageAmount">$0.00</span></td>
                    <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculatePerDiem(this)"></td>
                    <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculatePerDiem(this)"></td>
                    <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculatePerDiem(this)"></td>
                    <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculatePerDiem(this)"></td>
                    <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0"></td>
                    <td class="bordered p-2 text-center"><span class="totalPerDay">0.00</span></td>
                </tr>
            </tbody>
        </table>

        <div class="mt-4 flex justify-between">
            <button onclick="addDayRow()" class="bg-blue-500 text-white py-2 px-4 rounded">Add Day</button>
            <button onclick="removeDayRow()" class="bg-red-500 text-white py-2 px-4 rounded">Remove Day</button>
        </div>

        <!-- Summary Section -->
        <div class="grid grid-cols-2 gap-4 mt-8">
            <div class="font-bold">Total:</div><div><span id="totalAmount">$0.00</span></div>
            <div class="font-bold">Less Cash Advance:</div><div><input type="number" class="border p-2 w-full" oninput="calculateBalance()"></div>
            <div class="font-bold">Due Employee:</div><div><span id="dueEmployee">$0.00</span></div>
            <div class="font-bold">Due MCHD:</div><div><span id="dueMCHD">$0.00</span></div>
        </div>

        <!-- Signature Section -->
        <div class="mt-8 p-4 bordered bg-gray-100 rounded">
            <p>By typing my name below, I acknowledge this as my electronic signature.</p>
            <div class="flex space-x-4 mt-2">
                <div>
                    <label class="font-bold">Employee Signature:</label>
                    <input type="text" class="border p-2 w-full" required>
                </div>
                <div>
                    <label class="font-bold">Date:</label>
                    <input type="date" class="border p-2" required>
                </div>
                <div>
                    <label class="font-bold">Supervisor Approval:</label>
                    <input type="text" class="border p-2 w-full" required>
                </div>
                <div>
                    <label class="font-bold">Date:</label>
                    <input type="date" class="border p-2" required>
                </div>
            </div>
        </div>
    </div>

    <script>
        const mileageRate = 0.67;

        function calculateMileageAmount(input) {
            const miles = parseFloat(input.value) || 0;
            const mileageAmount = miles * mileageRate;
            input.closest('tr').querySelector('.mileageAmount').innerText = `$${mileageAmount.toFixed(2)}`;
            calculateTotal();
        }

        function calculatePerDiem(input) {
            const row = input.closest('tr');
            const isFirstOrLastDay = row.rowIndex === 1 || row.rowIndex === document.getElementById("expenseTableBody").rows.length;
            const total = Array.from(row.querySelectorAll('input[type="number"]'))
                .slice(4, 9) // B, L, D, I, Other
                .reduce((sum, input) => sum + (parseFloat(input.value) || 0), 0);
            const adjustedTotal = isFirstOrLastDay ? total * 0.75 : total;
            row.querySelector('.totalPerDay').innerText = `$${adjustedTotal.toFixed(2)}`;
            calculateTotal();
        }

        function calculateTotal() {
            const rows = document.getElementById("expenseTableBody").querySelectorAll('tr');
            const total = Array.from(rows).reduce((sum, row) => {
                const perDayTotal = parseFloat(row.querySelector('.totalPerDay').innerText.replace('$', '')) || 0;
                return sum + perDayTotal;
            }, 0);
            document.getElementById("totalAmount").innerText = `$${total.toFixed(2)}`;
        }

        function addDayRow() {
            const tableBody = document.getElementById('expenseTableBody');
            const newRow = document.createElement('tr');
            newRow.classList.add('bg-gray-200');
            newRow.innerHTML = `
                <td class="bordered p-2"><input type="date" class="border p-2 w-full"></td>
                <td class="bordered p-2"><input type="text" class="border p-2 w-full"></td>
                <td class="bordered p-2"><input type="text" class="border p-2 w-full"></td>
                <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculateMileageAmount(this)"></td>
                <td class="bordered p-2"><span class="mileageAmount">$0.00</span></td>
                <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculatePerDiem(this)"></td>
                <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculatePerDiem(this)"></td>
                <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculatePerDiem(this)"></td>
                <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0" oninput="calculatePerDiem(this)"></td>
                <td class="bordered p-2"><input type="number" class="border p-2 w-full" value="0"></td>
                <td class="bordered p-2 text-center"><span class="totalPerDay">$0.00</span></td>
            `;
            tableBody.appendChild(newRow);
        }

        function removeDayRow() {
            const tableBody = document.getElementById('expenseTableBody');
            if (tableBody.rows.length > 1) {
                tableBody.deleteRow(-1);
                calculateTotal();
            }
        }

        function calculateBalance() {
            const total = parseFloat(document.getElementById("totalAmount").innerText.replace('$', '')) || 0;
            const advance = parseFloat(document.querySelector("input[type='number']").value) || 0;
            document.getElementById("dueEmployee").innerText = `$${(total - advance).toFixed(2)}`;
            document.getElementById("dueMCHD").innerText = `$${(advance - total).toFixed(2)}`;
        }
    </script>
</body>
</html>