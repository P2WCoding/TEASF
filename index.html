<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCHD Travel Expense Account Settlement Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .form-container {
			width: 100%; /* Full width on small screens */
			max-width: 1200px; /* Maximum width on larger screens */
			margin: 0 auto; /* Center the form */
			padding: 1rem; /* Add padding for spacing */
		}

		.from-to-field {
			overflow: hidden; /* Hide scrollbars */
			resize: none; /* Prevent manual resizing */
			white-space: pre-wrap; /* Preserve whitespace and allow text wrapping */
		}

		textarea {
			overflow-wrap: break-word; /* Ensures long text wraps within the textarea */
			white-space: pre-wrap; /* Preserves spaces and allows for text wrapping */
		}

		.bordered { border: 1px solid #ccc; }
        .bg-gray-200 { background-color: #f7f7f7; }
        .bg-blue-light { background-color: #e3f2fd; }
        .text-center { text-align: center; }
        .font-bold { font-weight: bold; }
        .rounded-lg { border-radius: 8px; }
        .shadow { box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); }
        .p-4 { padding: 1rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
        .input-expanded { width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
		table {
			width: 100%; /* Full width of container */
			border-collapse: collapse; /* Merge borders for a cleaner look */
		}

		td, th {
			padding: 0.5rem; /* Add padding for readability */
			border: 1px solid #ddd; /* Border for cells */
			width: auto; /* Allow cells to adapt width */
		}

		input[type="text"], input[type="date"], input[type="number"], textarea {
			width: 100%; /* Take full width of cell */
			box-sizing: border-box; /* Include padding and border in the width */
			font-size: 1rem; /* Responsive font size */
		}

		textarea {
			overflow: hidden;
			resize: none; /* Prevent manual resizing */
			white-space: pre-wrap; /* Allow text wrapping */
		}
		
		.flex-container {
			display: flex;
			flex-wrap: wrap;
			gap: 1rem;
		}

		.flex-item {
			flex: 1 1 100%; /* Full width on small screens */
		}

		@media (min-width: 768px) {
			.flex-item {
				flex: 1 1 calc(50% - 1rem); /* Two columns on medium screens */
			}
		}

		@media (min-width: 1024px) {
			.flex-item {
				flex: 1 1 calc(33.33% - 1rem); /* Three columns on larger screens */
			}
		}
		
		body {
			font-size: 1rem; /* Base font size */
		}

		@media (min-width: 768px) {
			body {
				font-size: 1.1rem; /* Slightly larger font on medium screens */
			}
		}

		@media (min-width: 1024px) {
			body {
				font-size: 1.2rem; /* Larger font on large screens */
			}
		}
		
		@media (max-width: 600px) {
			td, th {
				font-size: 0.9rem;
			}
		}
    </style>
</head>
<body class="p-8 bg-green-500">

    <div class="bordered p-8 bg-blue-light rounded-lg shadow">
        <h1 class="text-center font-bold text-xl mb-4">MCHD Travel Expense Account Settlement Form</h1>

        <!-- Instructions Section -->
        <div class="mb-4">
            <h2 class="font-bold">Traveler Instructions:</h2>
            <p>Complete all applicable sections of this form based on actual travel expenses and forward it to your supervisor for approval. Attach all supporting documents.</p>

            <h2 class="font-bold mt-2">Supervisor Instructions:</h2>
            <p>Review and approve the completed form, then submit it to the Business Office within 30 days of the last day of travel.</p>
        </div>

        <!-- Travel Details Section -->
        <div class="grid grid-cols-3 gap-4 mb-4">
            <div><label class="font-bold">Name:</label> <input type="text" class="border p-2 w-full rounded"></div>
            <div><label class="font-bold">Mileage Rate:</label> <input type="text" value="$0.67" class="border p-2 w-full rounded" readonly></div>
            <div><label class="font-bold">Total Miles:</label> <input type="number" id="totalMiles" class="border p-2 w-full rounded" oninput="calculateMileage()"></div>
        </div>

        <!-- Expense Table -->
        <table class="w-full mt-4 bordered text-center">
            <thead>
                <tr class="bg-gray-200">
                    <th class="bordered p-2">Date of Travel</th>
                    <th class="bordered p-2">From</th>
                    <th class="bordered p-2">To</th>
                    <th class="bordered p-2">Miles</th>
                    <th class="bordered p-2">Mileage Amount</th>
                    <th class="bordered p-2">B</th>
                    <th class="bordered p-2">L</th>
                    <th class="bordered p-2">D</th>
                    <th class="bordered p-2">I</th>
                    <th class="bordered p-2">Other</th>
                    <th class="bordered p-2">Total Per Day</th>
                </tr>
            </thead>
            <tbody id="expenseTableBody">
				<tr class="bg-gray-100">
					<td class="bordered p-2"><input type="date" class="border p-2 w-full rounded"></td>
					<td class="bordered p-2">
						<textarea class="border p-2 w-full rounded resize-none from-to-field" rows="1" 
							oninput="autoResizeTextArea(this)"></textarea>
					</td>
					<td class="bordered p-2">
						<textarea class="border p-2 w-full rounded resize-none from-to-field" rows="1" 
							oninput="autoResizeTextArea(this)"></textarea>
					</td>
					<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculateMileageAmount(this)"></td>
					<td class="bordered p-2"><span class="mileageAmount">$0.00</span></td>
					<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculatePerDiem(this)"></td>
					<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculatePerDiem(this)"></td>
					<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculatePerDiem(this)"></td>
					<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculatePerDiem(this)"></td>
					<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0"></td>
					<td class="bordered p-2 text-center"><span class="totalPerDay">$0.00</span></td>
				</tr>
			</tbody>
        </table>

        <!-- Add and Remove Day Buttons -->
        <div class="mt-4 flex justify-between">
            <button onclick="addDay()" class="bg-blue-500 text-white py-2 px-4 rounded">Add Day</button>
            <button onclick="removeDay()" class="bg-red-500 text-white py-2 px-4 rounded">Remove Day</button>
        </div>

        <!-- Summary Section -->
        <div class="flex-container mt-8">
			<div class="flex-item font-bold">Total Mileage:</div>
			<div class="flex-item"><span id="totalMileage" class="font-bold">$0.00</span></div>
			<div class="flex-item font-bold">Total Per Day:</div>
			<div class="flex-item"><span id="totalPerDay" class="font-bold">$0.00</span></div>
			<div class="flex-item font-bold">Total Due Employee:</div>
			<div class="flex-item"><span id="totalDueEmployee" class="font-bold">$0.00</span></div>
		</div>

        <!-- Signature Section -->
		<div class="mt-8 p-4 bordered bg-gray-100 rounded-lg">
			<p>By typing my name below, I acknowledge this as my electronic signature.</p>
			<div class="flex items-center space-x-4 mt-2">
				<div class="flex items-center space-x-2 w-full">
					<label class="font-bold">Employee Signature:</label>
					<input type="text" class="border p-2 rounded w-full" required>
				</div>
				<div class="flex items-center space-x-2">
					<label class="font-bold">Date:</label>
					<input type="date" class="border p-2 rounded" required>
				</div>
			</div>
		</div>
    </div>

    <!-- JavaScript Functions -->
    <script>
        const mileageRate = 0.67;

		function calculateMileageAmount(input) {
			const miles = parseFloat(input.value) || 0;
			const mileageAmount = miles * mileageRate;
			input.closest('tr').querySelector('.mileageAmount').innerText = `$${mileageAmount.toFixed(2)}`;
			calculateTotals();
		}
		
		document.addEventListener('input', function(event) {
			if (event.target.matches('.from-to-field')) autoResizeTextArea(event.target);
			if (event.target.matches('[type="number"]')) calculateTotals();
		});

		function calculatePerDiem(input) {
			const row = input.closest('tr');
			const isFirstOrLastDay = row === row.closest('tbody').rows[0] || row === row.closest('tbody').lastElementChild;

			const [breakfast, lunch, dinner, incidentals, other] = Array.from(row.querySelectorAll('input[type="number"]')).slice(1, 6).map(input => parseFloat(input.value) || 0);
			const multiplier = isFirstOrLastDay ? 0.75 : 1;
			
			const totalPerDay = (breakfast + lunch + dinner + incidentals + other) * multiplier + parseFloat(row.querySelector('.mileageAmount').innerText.replace('$', '')) || 0;
			row.querySelector('.totalPerDay').innerText = `$${totalPerDay.toFixed(2)}`;
			calculateTotals();
		}

		function calculateTotals() {
			const rows = document.querySelectorAll("#expenseTableBody tr");
			let totalMileage = 0;
			let totalPerDay = 0;

			rows.forEach(row => {
				totalMileage += parseFloat(row.querySelector('.mileageAmount').innerText.replace('$', '')) || 0;
				totalPerDay += parseFloat(row.querySelector('.totalPerDay').innerText.replace('$', '')) || 0;
			});

			document.getElementById("totalMileage").innerText = `$${totalMileage.toFixed(2)}`;
			document.getElementById("totalPerDay").innerText = `$${totalPerDay.toFixed(2)}`;
			document.getElementById("totalDueEmployee").innerText = `$${(totalMileage + totalPerDay).toFixed(2)}`;
		}

		function autoResizeTextArea(element) {
			element.style.height = 'auto';
			element.style.height = element.scrollHeight + 'px';
		}

		function addDay() {
			const tableBody = document.getElementById('expenseTableBody');
			const newRow = document.createElement('tr');
			newRow.classList.add('bg-gray-100');
			newRow.innerHTML = `
				<td class="bordered p-2"><input type="date" class="border p-2 w-full rounded"></td>
				<td class="bordered p-2"><textarea class="border p-2 w-full rounded resize-none from-to-field" rows="1" oninput="autoResizeTextArea(this)"></textarea></td>
				<td class="bordered p-2"><textarea class="border p-2 w-full rounded resize-none from-to-field" rows="1" oninput="autoResizeTextArea(this)"></textarea></td>
				<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculateMileageAmount(this)"></td>
				<td class="bordered p-2"><span class="mileageAmount">$0.00</span></td>
				<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculatePerDiem(this)"></td>
				<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculatePerDiem(this)"></td>
				<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculatePerDiem(this)"></td>
				<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0" oninput="calculatePerDiem(this)"></td>
				<td class="bordered p-2"><input type="number" class="border p-2 w-full rounded" value="0"></td>
				<td class="bordered p-2 text-center"><span class="totalPerDay">$0.00</span></td>
			`;
			tableBody.appendChild(newRow);
		}

		function removeDay() {
			const tableBody = document.getElementById('expenseTableBody');
			if (tableBody.rows.length > 1) {
				tableBody.deleteRow(-1);
			}
		}
    </script>
</body>
</html>